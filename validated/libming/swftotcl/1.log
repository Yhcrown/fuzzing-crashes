load mingc.so mingc
set m [newSWFMovie]
#set m [newSWFMovie](7);

#add setscale here
setDimension $m (11000, 8000);

# SWF_DOACTION 
    27:SWFACTION_CONSTANTPOOL
=================================================================
==68081==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x603000000030 at pc 0x0000004e682e bp 0x7fff6e654fb0 sp 0x7fff6e654fa8
READ of size 8 at 0x603000000030 thread T0
    #0 0x4e682d in getName (/workspace/check/libming/util/swftotcl+0x4e682d)
    #1 0x4da36c in decompileGETMEMBER (/workspace/check/libming/util/swftotcl+0x4da36c)
    #2 0x4d8807 in decompileAction (/workspace/check/libming/util/swftotcl+0x4d8807)
    #3 0x4e5c15 in decompileActions (/workspace/check/libming/util/swftotcl+0x4e5c15)
    #4 0x4e5af3 in decompile5Action (/workspace/check/libming/util/swftotcl+0x4e5af3)
    #5 0x4d07e4 in outputSWF_DOACTION (/workspace/check/libming/util/swftotcl+0x4d07e4)
    #6 0x4ce63c in outputBlock (/workspace/check/libming/util/swftotcl+0x4ce63c)
    #7 0x4d607e in readMovie (/workspace/check/libming/util/swftotcl+0x4d607e)
    #8 0x4d5020 in main (/workspace/check/libming/util/swftotcl+0x4d5020)
    #9 0x7f54651aa0b2 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x270b2)
    #10 0x41b3cd in _start (/workspace/check/libming/util/swftotcl+0x41b3cd)

0x603000000030 is located 0 bytes to the right of 32-byte region [0x603000000010,0x603000000030)
allocated by thread T0 here:
    #0 0x493b0d in malloc (/workspace/check/libming/util/swftotcl+0x493b0d)
    #1 0x4f0e58 in parseSWF_ACTIONRECORD (/workspace/check/libming/util/swftotcl+0x4f0e58)
    #2 0x5108a5 in parseSWF_DOACTION (/workspace/check/libming/util/swftotcl+0x5108a5)
    #3 0x4d6939 in blockParse (/workspace/check/libming/util/swftotcl+0x4d6939)
    #4 0x4d5f95 in readMovie (/workspace/check/libming/util/swftotcl+0x4d5f95)
    #5 0x4d5020 in main (/workspace/check/libming/util/swftotcl+0x4d5020)
    #6 0x7f54651aa0b2 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x270b2)

SUMMARY: AddressSanitizer: heap-buffer-overflow (/workspace/check/libming/util/swftotcl+0x4e682d) in getName
Shadow bytes around the buggy address:
  0x0c067fff7fb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c067fff7fc0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c067fff7fd0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c067fff7fe0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c067fff7ff0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0c067fff8000: fa fa 00 00 00 00[fa]fa fd fd fd fd fa fa fd fd
  0x0c067fff8010: fd fd fa fa 00 00 00 00 fa fa 00 00 00 00 fa fa
  0x0c067fff8020: 00 00 00 00 fa fa 00 00 00 00 fa fa 00 00 00 fa
  0x0c067fff8030: fa fa 00 00 00 fa fa fa 00 00 00 fa fa fa 00 00
  0x0c067fff8040: 00 fa fa fa 00 00 00 fa fa fa 00 00 00 fa fa fa
  0x0c067fff8050: 00 00 00 fa fa fa 00 00 00 fa fa fa 00 00 00 fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==68081==ABORTING